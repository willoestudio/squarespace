document.addEventListener("DOMContentLoaded",function(){let t=document.querySelector(".blog-basic-grid, .blog-list, .summary-block-wrapper"),e=document.querySelector(".category-filter");if(!t||!e)return;let l=Array.from(t.querySelectorAll(".blog-item"));l.forEach(t=>{let e=t.querySelector("h1, h2, h3"),l=e?e.textContent.trim():"Untitled";t.setAttribute("data-title",l.toLowerCase());let a=t.querySelector("time");if(a){let r=new Date(a.getAttribute("datetime")||a.textContent);isNaN(r)||t.setAttribute("data-date",r.toISOString())}let o=t.querySelectorAll(".blog-categories"),i=Array.from(o).map(t=>t.textContent.trim().toLowerCase().replace(/\s+/g,"-"));t.setAttribute("data-categories",i.join(","))}),fetch("/blog?format=json").then(t=>t.json()).then(t=>{let a=new Set;t.items.forEach(t=>{t.categories&&t.categories.forEach(t=>a.add(t))});let r=Array.from(a).sort(),o=document.createElement("button");o.className="filter-btn active",o.textContent="All",o.setAttribute("data-filter","all"),e.appendChild(o),r.forEach(t=>{let l=document.createElement("button");l.className="filter-btn",l.textContent=t,l.setAttribute("data-filter",t.toLowerCase().replace(/\s+/g,"-")),e.appendChild(l)});let i=document.querySelectorAll(".filter-btn");i.forEach(t=>{t.addEventListener("click",()=>{let e=t.getAttribute("data-filter");i.forEach(t=>t.classList.remove("active")),t.classList.add("active"),l.forEach(t=>{let l=t.getAttribute("data-categories")||"";t.style.display="all"===e||l.includes(e)?"":"none"})})})});let a=document.getElementById("sort-trigger"),r=document.querySelector(".sort-options"),o=document.querySelectorAll(".sort-option");a&&r&&o.length>0&&(a.addEventListener("click",()=>{r.style.display="block"===r.style.display?"none":"block"}),o.forEach(e=>{e.addEventListener("click",function(){let e=this.dataset.sort;a.textContent="Sort: "+this.textContent,r.style.display="none";let o=[...l].sort((t,l)=>{let a=t.dataset.title||"",r=l.dataset.title||"",o=new Date(t.dataset.date||0),i=new Date(l.dataset.date||0);return"date-desc"===e?i-o:"date-asc"===e?o-i:"title-asc"===e?a.localeCompare(r):"title-desc"===e?r.localeCompare(a):void 0});o.forEach(e=>t.appendChild(e))})}))});